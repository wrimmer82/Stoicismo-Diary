<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Stoic Journey - Crescita Personale Attraverso lo Stoicismo</title>
    <meta name="description" content="365 giorni di saggezza stoica. Trasforma la tua vita attraverso la filosofia di Marco Aurelio, Epitteto e Seneca.">
    
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --primary-color: #8B4513;
            --secondary-color: #D4AF37;
            --background: #FFF8DC;
            --text-dark: #2C1810;
            --text-light: #6B4423;
            --card-bg: #FFFFFF;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: linear-gradient(135deg, var(--background) 0%, #F5E6D3 100%);
            color: var(--text-dark);
            line-height: 1.7;
        }

        .navbar {
            background: rgba(139, 69, 19, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--secondary-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .hero {
            text-align: center;
            padding: 150px 20px 80px;
            background: linear-gradient(135deg, var(--primary-color) 0%, #6B3410 100%);
            color: white;
            margin-top: 60px;
            border-radius: 20px;
            box-shadow: 0 10px 30px var(--shadow);
        }

        .hero h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero .subtitle {
            font-size: 1.5em;
            margin-bottom: 30px;
            opacity: 0.95;
        }

        .cta-button {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 18px 40px;
            border-radius: 30px;
            text-decoration: none;
            font-size: 1.2em;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin-top: 20px;
        }

        .cta-button:hover {
            background: #B8941D;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .section {
            padding: 80px 20px;
        }

        .section-title {
            text-align: center;
            font-size: 2.5em;
            color: var(--primary-color);
            margin-bottom: 50px;
        }

        .pillars-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .pillar-card {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 15px var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            border-left: 5px solid var(--secondary-color);
        }

        .pillar-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px var(--shadow);
        }

        .pillar-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .pillar-card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .daily-challenge {
            background: var(--card-bg);
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
            margin-bottom: 40px;
            border-top: 5px solid var(--secondary-color);
        }

        .challenge-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .challenge-day {
            font-size: 1.2em;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .challenge-title {
            font-size: 2.2em;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .quote {
            font-size: 1.4em;
            font-style: italic;
            color: var(--text-dark);
            border-left: 4px solid var(--secondary-color);
            padding-left: 25px;
            margin: 30px 0;
            line-height: 1.8;
        }

        .quote-author {
            text-align: right;
            color: var(--text-light);
            font-size: 1.1em;
            margin-top: 15px;
        }

        .theme-badge {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-size: 1em;
            margin: 20px 0;
            font-weight: bold;
        }

        .interpretation {
            background: #F5F5F5;
            padding: 30px;
            border-radius: 10px;
            margin: 25px 0;
            line-height: 1.8;
        }

        .interpretation h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .micro-challenge {
            background: linear-gradient(135deg, var(--primary-color) 0%, #6B3410 100%);
            color: white;
            padding: 35px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .micro-challenge h4 {
            font-size: 1.6em;
            margin-bottom: 20px;
        }

        .difficulty {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 1em;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.2);
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 1.5em;
            color: var(--text-light);
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #c62828;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
        }

        .feature-card {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px var(--shadow);
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-10px);
        }

        .feature-icon {
            font-size: 3.5em;
            margin-bottom: 20px;
        }

        .feature-card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .testimonials {
            background: var(--card-bg);
            padding: 60px 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .testimonial-card {
            background: #F5F5F5;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid var(--secondary-color);
        }

        .testimonial-text {
            font-style: italic;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .testimonial-author {
            color: var(--text-light);
            font-weight: bold;
        }

        .pricing-section {
            background: var(--card-bg);
            padding: 60px 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 40px;
        }

        .pricing-card {
            background: white;
            border: 2px solid var(--secondary-color);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px var(--shadow);
        }

        .pricing-card.featured {
            border: 3px solid var(--primary-color);
            transform: scale(1.05);
        }

        .price {
            font-size: 2.5em;
            color: var(--primary-color);
            margin: 20px 0;
            font-weight: bold;
        }

        .pricing-features {
            list-style: none;
            margin: 30px 0;
            text-align: left;
        }

        .pricing-features li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .pricing-features li:before {
            content: "‚úì ";
            color: var(--secondary-color);
            font-weight: bold;
            margin-right: 10px;
        }

        .faq-section {
            background: var(--card-bg);
            padding: 60px 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .faq-item {
            background: #F5F5F5;
            padding: 25px;
            border-radius: 10px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .faq-item:hover {
            background: #E8E8E8;
        }

        .faq-question {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .faq-answer {
            margin-top: 15px;
            display: none;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .faq-item.active .faq-answer {
            display: block;
        }

        .newsletter-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, #6B3410 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .newsletter-form {
            display: flex;
            max-width: 500px;
            margin: 30px auto 0;
            gap: 10px;
        }

        .newsletter-form input {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
        }

        .newsletter-form button {
            padding: 15px 30px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .newsletter-form button:hover {
            background: #B8941D;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
            margin-top: 60px;
            border-top: 2px solid var(--secondary-color);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--text-light);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--primary-color);
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.2em;
            }

            .hero .subtitle {
                font-size: 1.2em;
            }

            .nav-links {
                display: none;
            }

            .pillars-container,
            .features-grid,
            .pricing-grid {
                grid-template-columns: 1fr;
            }

            .daily-challenge {
                padding: 30px 20px;
            }

            .quote {
                font-size: 1.2em;
            }

            .newsletter-form {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo">üèõÔ∏è The Stoic Journey</a>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#pillars">Pilastri</a></li>
                <li><a href="#challenge">Sfida Oggi</a></li>
                <li><a href="#pricing">Prezzi</a></li>
                <li><a href="#faq">FAQ</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="container">
        <section id="home" class="hero" data-aos="fade-up">
            <h1>üèõÔ∏è The Stoic Journey</h1>
            <p class="subtitle">365 giorni di crescita attraverso la saggezza stoica</p>
            <p style="font-size: 1.2em; margin: 20px 0;">
                Trasforma la tua vita con le filosofie di Marco Aurelio, Epitteto e Seneca
            </p>
            <a href="#challenge" class="cta-button">Inizia il Viaggio</a>
        </section>

        <!-- Pillars Section -->
        <section id="pillars" class="section">
            <h2 class="section-title" data-aos="fade-up">I Quattro Pilastri dello Stoicismo</h2>
            <div class="pillars-container">
                <div class="pillar-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="pillar-icon">üéØ</div>
                    <h3>Dicotomia del Controllo</h3>
                    <p>Distingui ci√≤ che puoi controllare da ci√≤ che non puoi. Concentra la tua energia solo su ci√≤ che dipende da te: pensieri, azioni e valori.</p>
                </div>
                <div class="pillar-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="pillar-icon">‚ö°</div>
                    <h3>Virt√π & Carattere</h3>
                    <p>La vera felicit√† nasce dallo sviluppo del carattere attraverso le quattro virt√π cardinali: saggezza, coraggio, giustizia e temperanza.</p>
                </div>
                <div class="pillar-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="pillar-icon">üíÄ</div>
                    <h3>Memento Mori</h3>
                    <p>Ricorda che sei mortale. La consapevolezza della morte d√† valore e urgenza alla vita presente, eliminando le preoccupazioni futili.</p>
                </div>
                <div class="pillar-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="pillar-icon">‚ù§Ô∏è</div>
                    <h3>Amor Fati</h3>
                    <p>Ama il tuo destino. Accetta e abbraccia tutto ci√≤ che ti accade come necessario e perfetto per la tua crescita personale.</p>
                </div>
            </div>
        </section>

        <!-- Daily Challenge Section -->
        <section id="challenge" class="section">
            <h2 class="section-title" data-aos="fade-up">Sfida Stoica del Giorno</h2>
            <div id="daily-challenge-container" class="loading" data-aos="fade-up">
                Caricamento della sfida quotidiana...
            </div>
        </section>

        <!-- Features Section -->
        <section class="section">
            <h2 class="section-title" data-aos="fade-up">Cosa Include The Stoic Journey</h2>
            <div class="features-grid">
                <div class="feature-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="feature-icon">üìö</div>
                    <h3>365 Sfide Quotidiane</h3>
                    <p>Una nuova sfida stoica ogni giorno per un anno intero di crescita personale continua.</p>
                </div>
                <div class="feature-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="feature-icon">üéØ</div>
                    <h3>Micro-Sfide Pratiche</h3>
                    <p>Azioni concrete da completare in 5-10 minuti per applicare la filosofia nella vita quotidiana.</p>
                </div>
                <div class="feature-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="feature-icon">üìñ</div>
                    <h3>Citazioni Autentiche</h3>
                    <p>Frasi originali dai grandi filosofi stoici con riferimenti precisi alle opere.</p>
                </div>
                <div class="feature-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="feature-icon">üí°</div>
                    <h3>Interpretazioni Moderne</h3>
                    <p>Spiegazioni chiare su come applicare la saggezza antica al mondo contemporaneo.</p>
                </div>
                <div class="feature-card" data-aos="fade-up" data-aos-delay="500">
                    <div class="feature-icon">üìä</div>
                    <h3>Tracciamento Progressi</h3>
                    <p>Monitora il tuo percorso e celebra i risultati raggiunti nel tuo viaggio stoico.</p>
                </div>
                <div class="feature-card" data-aos="fade-up" data-aos-delay="600">
                    <div class="feature-icon">üåü</div>
                    <h3>Difficolt√† Graduali</h3>
                    <p>Sfide di livello facile, medio e difficile per adattarsi alla tua esperienza.</p>
                </div>
            </div>
        </section>

        <!-- Testimonials -->
        <section class="section">
            <div class="testimonials" data-aos="fade-up">
                <h2 class="section-title">Cosa Dicono i Nostri Utenti</h2>
                <div class="testimonial-card" data-aos="fade-up" data-aos-delay="100">
                    <p class="testimonial-text">"The Stoic Journey ha trasformato il mio approccio alla vita. Ogni mattina trovo ispirazione e guida pratica per affrontare la giornata con serenit√†."</p>
                    <p class="testimonial-author">‚Äî Marco R., Imprenditore</p>
                </div>
                <div class="testimonial-card" data-aos="fade-up" data-aos-delay="200">
                    <p class="testimonial-text">"Le micro-sfide sono perfette: brevi ma profonde. In soli 10 minuti al giorno sto costruendo abitudini che cambiano davvero la mia vita."</p>
                    <p class="testimonial-author">‚Äî Laura T., Designer</p>
                </div>
                <div class="testimonial-card" data-aos="fade-up" data-aos-delay="300">
                    <p class="testimonial-text">"Finalmente ho trovato un modo concreto per applicare la filosofia stoica. Le interpretazioni moderne rendono tutto chiaro e applicabile."</p>
                    <p class="testimonial-author">‚Äî Alessandro P., Manager</p>
                </div>
            </div>
        </section>

        <!-- Pricing -->
        <section id="pricing" class="section">
            <div class="pricing-section" data-aos="fade-up">
                <h2 class="section-title">Scegli il Tuo Piano</h2>
                <div class="pricing-grid">
                    <div class="pricing-card" data-aos="fade-up" data-aos-delay="100">
                        <h3>Piano Mensile</h3>
                        <div class="price">‚Ç¨9.99<span style="font-size: 0.4em;">/mese</span></div>
                        <ul class="pricing-features">
                            <li>Accesso a tutte le 365 sfide</li>
                            <li>Micro-sfide quotidiane</li>
                            <li>Interpretazioni moderne</li>
                            <li>Tracciamento progressi base</li>
                        </ul>
                        <a href="#" class="cta-button">Inizia Ora</a>
                    </div>
                    <div class="pricing-card featured" data-aos="fade-up" data-aos-delay="200">
                        <h3>Piano Annuale</h3>
                        <div class="price">‚Ç¨79.99<span style="font-size: 0.4em;">/anno</span></div>
                        <p style="color: var(--secondary-color); font-weight: bold; margin: 10px 0;">Risparmia 33%</p>
                        <ul class="pricing-features">
                            <li>Tutto del piano mensile</li>
                            <li>Tracciamento avanzato</li>
                            <li>Riflessioni personali</li>
                            <li>Community privata</li>
                            <li>Contenuti bonus esclusivi</li>
                        </ul>
                        <a href="#" class="cta-button">Piano Migliore</a>
                    </div>
                    <div class="pricing-card" data-aos="fade-up" data-aos-delay="300">
                        <h3>Piano Lifetime</h3>
                        <div class="price">‚Ç¨199<span style="font-size: 0.4em;">una tantum</span></div>
                        <ul class="pricing-features">
                            <li>Accesso illimitato a vita</li>
                            <li>Tutte le funzionalit√† premium</li>
                            <li>Aggiornamenti futuri gratuiti</li>
                            <li>Supporto prioritario</li>
                            <li>Contenuti esclusivi lifetime</li>
                        </ul>
                        <a href="#" class="cta-button">Acquista Ora</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ -->
        <section id="faq" class="section">
            <div class="faq-section" data-aos="fade-up">
                <h2 class="section-title">Domande Frequenti</h2>
                <div class="faq-item">
                    <div class="faq-question">
                        Cos'√® The Stoic Journey?
                        <span>+</span>
                    </div>
                    <div class="faq-answer">
                        The Stoic Journey √® un programma di crescita personale basato sulla filosofia stoica. Ogni giorno ricevi una citazione autentica, un'interpretazione moderna e una micro-sfida pratica da completare.
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        Quanto tempo richiede al giorno?
                        <span>+</span>
                    </div>
                    <div class="faq-answer">
                        Le micro-sfide sono progettate per essere completate in 5-10 minuti. Puoi dedicare pi√π tempo se vuoi approfondire, ma anche solo 10 minuti al giorno possono fare la differenza.
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        √à adatto ai principianti?
                        <span>+</span>
                    </div>
                    <div class="faq-answer">
                        Assolutamente s√¨! Non serve conoscenza pregressa dello stoicismo. Ogni sfida include interpretazioni chiare e spiegazioni moderne che rendono la filosofia accessibile a tutti.
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        Posso cancellare in qualsiasi momento?
                        <span>+</span>
                    </div>
                    <div class="faq-answer">
                        S√¨, puoi cancellare il tuo abbonamento in qualsiasi momento. Non ci sono vincoli o penali. Se hai il piano lifetime, l'accesso √® tuo per sempre.
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        Le citazioni sono autentiche?
                        <span>+</span>
                    </div>
                    <div class="faq-answer">
                        S√¨, tutte le citazioni provengono direttamente dalle opere originali di Marco Aurelio, Epitteto, Seneca e altri filosofi stoici, con riferimenti precisi alle fonti.
                    </div>
                </div>
            </div>
        </section>

        <!-- Newsletter -->
        <section class="section">
            <div class="newsletter-section" data-aos="fade-up">
                <h2>Ricevi la Sfida Stoica nella Tua Email</h2>
                <p style="font-size: 1.2em; margin-top: 15px;">
                    Iscriviti alla newsletter e ricevi ogni giorno la sfida stoica direttamente nella tua casella email.
                </p>
                <form class="newsletter-form">
                    <input type="email" placeholder="La tua email" required>
                    <button type="submit">Iscriviti</button>
                </form>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>¬© 2025 The Stoic Journey | Creato con passione per la filosofia stoica</p>
        <div class="footer-links">
            <a href="#">Privacy Policy</a>
            <a href="#">Termini di Servizio</a>
            <a href="#">Contatti</a>
            <a href="#">Blog</a>
        </div>
        <p style="margin-top: 20px; font-size: 0.9em;">Marco Aurelio ‚Ä¢ Epitteto ‚Ä¢ Seneca</p>
    </footer>

    <!-- AOS Animation Library -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            once: true
        });

        // CONFIGURAZIONE SUPABASE
        const SUPABASE_URL = 'https://fayuadwpchhrxafbdntw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZheXVhZHdwY2hocnhhZmJkbnR3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUxMTY3NDksImV4cCI6MjA4MDY5Mjc0OX0._D_c4Q0NFFSRfwiMKbrbqcrSbGDYfUSQ6BqjKjhauRE';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Calcola il giorno dell'anno
        function getDayOfYear(date) {
            const start = new Date(date.getFullYear(), 0, 0);
            const diff = date - start;
            const oneDay = 1000 * 60 * 60 * 24;
            return Math.floor(diff / oneDay);
        }

        // Verifica se √® anno bisestile
        function isLeapYear(year) {
            return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
        }

        // Caricamento sfida del giorno
        async function loadTodayChallenge() {
            const container = document.getElementById('daily-challenge-container');
            
            try {
                const today = new Date();
                const dayOfYear = getDayOfYear(today);
                const year = today.getFullYear();
                const isLeap = isLeapYear(year);
                
                const { data, error } = await supabase
                    .from('sfide_quotidiane')
                    .select('*')
                    .eq('giorno', dayOfYear)
                    .single();
                
                if (error) throw error;
                
                if (!isLeap && data.is_leap_day) {
                    const { data: nextData, error: nextError } = await supabase
                        .from('sfide_quotidiane')
                        .select('*')
                        .eq('giorno', dayOfYear + 1)
                        .single();
                    
                    if (nextError) throw nextError;
                    renderChallenge(nextData);
                } else {
                    renderChallenge(data);
                }
                
            } catch (error) {
                console.error('Errore nel caricamento:', error);
                container.innerHTML = `
                    <div class="error">
                        <strong>Errore nel caricamento della sfida</strong>
                        <p>Verifica la connessione a Supabase. Dettagli: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Rendering della sfida
        function renderChallenge(sfida) {
            const container = document.getElementById('daily-challenge-container');
            
            const difficoltaColor = {
                'facile': '#4CAF50',
                'media': '#FF9800',
                'difficile': '#F44336'
            };
            
            container.className = 'daily-challenge';
            container.innerHTML = `
                <div class="challenge-header">
                    <div class="challenge-day">Giorno ${sfida.giorno}</div>
                    <h2 class="challenge-title">${sfida.data}</h2>
                </div>

                <div class="quote">
                    "${sfida.citazione}"
                    <div class="quote-author">‚Äî ${sfida.autore}</div>
                    <div style="text-align: right; font-size: 0.9em; margin-top: 5px; opacity: 0.8;">
                        ${sfida.opera}
                    </div>
                </div>

                <div style="text-align: center;">
                    <span class="theme-badge">
                        ${sfida.tema.toUpperCase()}
                    </span>
                </div>

                <div class="interpretation">
                    <h3>Interpretazione Moderna</h3>
                    <p>${sfida.interpretazione}</p>
                </div>

                <div class="micro-challenge">
                    <h4>Micro-Sfida del Giorno</h4>
                    <p>${sfida.micro_sfida}</p>
                    <span class="difficulty" style="background: ${difficoltaColor[sfida.difficolta]};">
                        Difficolt√†: ${sfida.difficolta.charAt(0).toUpperCase() + sfida.difficolta.slice(1)}
                    </span>
                </div>
            `;
        }

        // FAQ Accordion
        document.querySelectorAll('.faq-item').forEach(item => {
            item.addEventListener('click', () => {
                item.classList.toggle('active');
                const plus = item.querySelector('.faq-question span');
                plus.textContent = item.classList.contains('active') ? '‚àí' : '+';
            });
        });

        // Newsletter Form
        document.querySelector('.newsletter-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = e.target.querySelector('input').value;
            alert(`Grazie per l'iscrizione! Conferma la tua email: ${email}`);
            e.target.reset();
        });

        // Smooth Scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Inizializzazione
        document.addEventListener('DOMContentLoaded', loadTodayChallenge);
    </script>
</body>
</html>
